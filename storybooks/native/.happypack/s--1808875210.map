{"version":3,"sources":["node_modules/react-native/Libraries/Utilities/MatrixMath.js"],"names":["invariant","require","MatrixMath","createIdentityMatrix","createCopy","m","createOrthographic","left","right","bottom","top","near","far","a","b","c","tx","ty","tz","createFrustum","r_width","r_height","r_depth","x","y","A","B","C","D","createPerspective","fovInRadians","aspect","h","Math","tan","createTranslate2d","mat","reuseTranslate2dCommand","matrixCommand","reuseTranslate3dCommand","z","createScale","factor","reuseScaleCommand","reuseScale3dCommand","reusePerspectiveCommand","p","reuseScaleXCommand","reuseScaleYCommand","reuseScaleZCommand","reuseRotateXCommand","radians","cos","sin","reuseRotateYCommand","amount","reuseRotateZCommand","createRotateZ","reuseSkewXCommand","reuseSkewYCommand","multiplyInto","out","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b0","b1","b2","b3","determinant","matrix","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","inverse","det","transpose","multiplyVectorByMatrix","v","vx","vy","vz","vw","v3Length","sqrt","v3Normalize","vector","im","v3Dot","v3Combine","aScale","bScale","v3Cross","quaternionToDegreesXYZ","q","row","qx","qy","qz","qw","qw2","qx2","qy2","qz2","test","unit","conv","PI","atan2","roundTo3Places","asin","n","arr","toString","split","round","decomposeMatrix","transformMatrix","length","perspective","quaternion","scale","skew","translation","perspectiveMatrix","i","push","j","value","rightHandSide","inversePerspectiveMatrix","transposedInversePerspectiveMatrix","pdum3","max","rotationDegrees","rotate","rotateX","rotateY","scaleX","scaleY","translateX","translateY","module","exports"],"mappings":"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","file":"MatrixMath.js","sourceRoot":"/home/phz/workspace/brimitives/storybooks/native","sourcesContent":["/**\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule MatrixMath\n * @noflow\n */\n/* eslint-disable space-infix-ops */\n'use strict';\n\nvar invariant = require('fbjs/lib/invariant');\n\n/**\n * Memory conservative (mutative) matrix math utilities. Uses \"command\"\n * matrices, which are reusable.\n */\nvar MatrixMath = {\n  createIdentityMatrix: function() {\n    return [\n      1,0,0,0,\n      0,1,0,0,\n      0,0,1,0,\n      0,0,0,1\n    ];\n  },\n\n  createCopy: function(m) {\n    return [\n      m[0],  m[1],  m[2],  m[3],\n      m[4],  m[5],  m[6],  m[7],\n      m[8],  m[9],  m[10], m[11],\n      m[12], m[13], m[14], m[15],\n    ];\n  },\n\n  createOrthographic: function(left, right, bottom, top, near, far) {\n    var a = 2 / (right - left);\n    var b = 2 / (top - bottom);\n    var c = -2 / (far - near);\n\n    var tx = -(right + left) / (right - left);\n    var ty = -(top + bottom) / (top - bottom);\n    var tz = -(far + near) / (far - near);\n\n    return [\n        a,  0,  0,  0,\n        0,  b,  0,  0,\n        0,  0,  c,  0,\n        tx, ty, tz, 1\n    ];\n  },\n\n  createFrustum: function(left, right, bottom, top, near, far) {\n    var r_width  = 1 / (right - left);\n    var r_height = 1 / (top - bottom);\n    var r_depth  = 1 / (near - far);\n    var x = 2 * (near * r_width);\n    var y = 2 * (near * r_height);\n    var A = (right + left) * r_width;\n    var B = (top + bottom) * r_height;\n    var C = (far + near) * r_depth;\n    var D = 2 * (far * near * r_depth);\n    return [\n      x, 0, 0, 0,\n      0, y, 0, 0,\n      A, B, C,-1,\n      0, 0, D, 0,\n    ];\n  },\n\n  /**\n   * This create a perspective projection towards negative z\n   * Clipping the z range of [-near, -far]\n   *\n   * @param fovInRadians - field of view in randians\n   */\n  createPerspective: function(fovInRadians, aspect, near, far) {\n    var h = 1 / Math.tan(fovInRadians / 2);\n    var r_depth  = 1 / (near - far);\n    var C = (far + near) * r_depth;\n    var D = 2 * (far * near * r_depth);\n    return [\n      h/aspect, 0, 0, 0,\n      0, h, 0, 0,\n      0, 0, C,-1,\n      0, 0, D, 0,\n    ];\n  },\n\n  createTranslate2d: function(x, y) {\n    var mat = MatrixMath.createIdentityMatrix();\n    MatrixMath.reuseTranslate2dCommand(mat, x, y);\n    return mat;\n  },\n\n  reuseTranslate2dCommand: function(matrixCommand, x, y) {\n    matrixCommand[12] = x;\n    matrixCommand[13] = y;\n  },\n\n  reuseTranslate3dCommand: function(matrixCommand, x, y, z) {\n    matrixCommand[12] = x;\n    matrixCommand[13] = y;\n    matrixCommand[14] = z;\n  },\n\n  createScale: function(factor) {\n    var mat = MatrixMath.createIdentityMatrix();\n    MatrixMath.reuseScaleCommand(mat, factor);\n    return mat;\n  },\n\n  reuseScaleCommand: function(matrixCommand, factor) {\n    matrixCommand[0] = factor;\n    matrixCommand[5] = factor;\n  },\n\n  reuseScale3dCommand: function(matrixCommand, x, y, z) {\n    matrixCommand[0] = x;\n    matrixCommand[5] = y;\n    matrixCommand[10] = z;\n  },\n\n  reusePerspectiveCommand: function(matrixCommand, p) {\n    matrixCommand[11] = -1 / p;\n  },\n\n  reuseScaleXCommand(matrixCommand, factor) {\n    matrixCommand[0] = factor;\n  },\n\n  reuseScaleYCommand(matrixCommand, factor) {\n    matrixCommand[5] = factor;\n  },\n\n  reuseScaleZCommand(matrixCommand, factor) {\n    matrixCommand[10] = factor;\n  },\n\n  reuseRotateXCommand: function(matrixCommand, radians) {\n    matrixCommand[5] = Math.cos(radians);\n    matrixCommand[6] = Math.sin(radians);\n    matrixCommand[9] = -Math.sin(radians);\n    matrixCommand[10] = Math.cos(radians);\n  },\n\n  reuseRotateYCommand: function(matrixCommand, amount) {\n    matrixCommand[0] = Math.cos(amount);\n    matrixCommand[2] = -Math.sin(amount);\n    matrixCommand[8] = Math.sin(amount);\n    matrixCommand[10] = Math.cos(amount);\n  },\n\n  // http://www.w3.org/TR/css3-transforms/#recomposing-to-a-2d-matrix\n  reuseRotateZCommand: function(matrixCommand, radians) {\n    matrixCommand[0] = Math.cos(radians);\n    matrixCommand[1] = Math.sin(radians);\n    matrixCommand[4] = -Math.sin(radians);\n    matrixCommand[5] = Math.cos(radians);\n  },\n\n  createRotateZ: function(radians) {\n    var mat = MatrixMath.createIdentityMatrix();\n    MatrixMath.reuseRotateZCommand(mat, radians);\n    return mat;\n  },\n\n  reuseSkewXCommand: function(matrixCommand, radians) {\n    matrixCommand[4] = Math.tan(radians);\n  },\n\n  reuseSkewYCommand: function(matrixCommand, radians) {\n    matrixCommand[1] = Math.tan(radians);\n  },\n\n  multiplyInto: function(out, a, b) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n      a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n      a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n      a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n\n    var b0  = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\n    out[0] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[1] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[2] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[3] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[4]; b1 = b[5]; b2 = b[6]; b3 = b[7];\n    out[4] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[5] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[6] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[7] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[8]; b1 = b[9]; b2 = b[10]; b3 = b[11];\n    out[8] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[9] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[10] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[11] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[12]; b1 = b[13]; b2 = b[14]; b3 = b[15];\n    out[12] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[13] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[14] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[15] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n  },\n\n  determinant(matrix: Array<number>): number {\n    var [\n      m00, m01, m02, m03,\n      m10, m11, m12, m13,\n      m20, m21, m22, m23,\n      m30, m31, m32, m33\n    ] = matrix;\n    return (\n      m03 * m12 * m21 * m30 - m02 * m13 * m21 * m30 -\n      m03 * m11 * m22 * m30 + m01 * m13 * m22 * m30 +\n      m02 * m11 * m23 * m30 - m01 * m12 * m23 * m30 -\n      m03 * m12 * m20 * m31 + m02 * m13 * m20 * m31 +\n      m03 * m10 * m22 * m31 - m00 * m13 * m22 * m31 -\n      m02 * m10 * m23 * m31 + m00 * m12 * m23 * m31 +\n      m03 * m11 * m20 * m32 - m01 * m13 * m20 * m32 -\n      m03 * m10 * m21 * m32 + m00 * m13 * m21 * m32 +\n      m01 * m10 * m23 * m32 - m00 * m11 * m23 * m32 -\n      m02 * m11 * m20 * m33 + m01 * m12 * m20 * m33 +\n      m02 * m10 * m21 * m33 - m00 * m12 * m21 * m33 -\n      m01 * m10 * m22 * m33 + m00 * m11 * m22 * m33\n    );\n  },\n\n  /**\n   * Inverse of a matrix. Multiplying by the inverse is used in matrix math\n   * instead of division.\n   *\n   * Formula from:\n   * http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n   */\n  inverse(matrix: Array<number>): Array<number> {\n    var det = MatrixMath.determinant(matrix);\n    if (!det) {\n      return matrix;\n    }\n    var [\n      m00, m01, m02, m03,\n      m10, m11, m12, m13,\n      m20, m21, m22, m23,\n      m30, m31, m32, m33\n    ] = matrix;\n    return [\n      (m12*m23*m31 - m13*m22*m31 + m13*m21*m32 - m11*m23*m32 - m12*m21*m33 + m11*m22*m33) / det,\n      (m03*m22*m31 - m02*m23*m31 - m03*m21*m32 + m01*m23*m32 + m02*m21*m33 - m01*m22*m33) / det,\n      (m02*m13*m31 - m03*m12*m31 + m03*m11*m32 - m01*m13*m32 - m02*m11*m33 + m01*m12*m33) / det,\n      (m03*m12*m21 - m02*m13*m21 - m03*m11*m22 + m01*m13*m22 + m02*m11*m23 - m01*m12*m23) / det,\n      (m13*m22*m30 - m12*m23*m30 - m13*m20*m32 + m10*m23*m32 + m12*m20*m33 - m10*m22*m33) / det,\n      (m02*m23*m30 - m03*m22*m30 + m03*m20*m32 - m00*m23*m32 - m02*m20*m33 + m00*m22*m33) / det,\n      (m03*m12*m30 - m02*m13*m30 - m03*m10*m32 + m00*m13*m32 + m02*m10*m33 - m00*m12*m33) / det,\n      (m02*m13*m20 - m03*m12*m20 + m03*m10*m22 - m00*m13*m22 - m02*m10*m23 + m00*m12*m23) / det,\n      (m11*m23*m30 - m13*m21*m30 + m13*m20*m31 - m10*m23*m31 - m11*m20*m33 + m10*m21*m33) / det,\n      (m03*m21*m30 - m01*m23*m30 - m03*m20*m31 + m00*m23*m31 + m01*m20*m33 - m00*m21*m33) / det,\n      (m01*m13*m30 - m03*m11*m30 + m03*m10*m31 - m00*m13*m31 - m01*m10*m33 + m00*m11*m33) / det,\n      (m03*m11*m20 - m01*m13*m20 - m03*m10*m21 + m00*m13*m21 + m01*m10*m23 - m00*m11*m23) / det,\n      (m12*m21*m30 - m11*m22*m30 - m12*m20*m31 + m10*m22*m31 + m11*m20*m32 - m10*m21*m32) / det,\n      (m01*m22*m30 - m02*m21*m30 + m02*m20*m31 - m00*m22*m31 - m01*m20*m32 + m00*m21*m32) / det,\n      (m02*m11*m30 - m01*m12*m30 - m02*m10*m31 + m00*m12*m31 + m01*m10*m32 - m00*m11*m32) / det,\n      (m01*m12*m20 - m02*m11*m20 + m02*m10*m21 - m00*m12*m21 - m01*m10*m22 + m00*m11*m22) / det\n    ];\n  },\n\n  /**\n   * Turns columns into rows and rows into columns.\n   */\n   transpose(m: Array<number>): Array<number> {\n    return [\n      m[0], m[4], m[8],  m[12],\n      m[1], m[5], m[9],  m[13],\n      m[2], m[6], m[10], m[14],\n      m[3], m[7], m[11], m[15]\n    ];\n  },\n\n  /**\n   * Based on: http://tog.acm.org/resources/GraphicsGems/gemsii/unmatrix.c\n   */\n  multiplyVectorByMatrix(\n    v: Array<number>,\n    m: Array<number>\n  ): Array<number> {\n    var [vx, vy, vz, vw] = v;\n    return [\n      vx * m[0] + vy * m[4] + vz * m[8]  + vw * m[12],\n      vx * m[1] + vy * m[5] + vz * m[9]  + vw * m[13],\n      vx * m[2] + vy * m[6] + vz * m[10] + vw * m[14],\n      vx * m[3] + vy * m[7] + vz * m[11] + vw * m[15]\n    ];\n  },\n\n  /**\n   * From: https://code.google.com/p/webgl-mjs/source/browse/mjs.js\n   */\n  v3Length(a: Array<number>): number {\n    return Math.sqrt(a[0]*a[0] + a[1]*a[1] + a[2]*a[2]);\n  },\n\n  /**\n   * Based on: https://code.google.com/p/webgl-mjs/source/browse/mjs.js\n   */\n   v3Normalize(\n     vector: Array<number>,\n     v3Length: number\n    ): Array<number> {\n    var im = 1 / (v3Length || MatrixMath.v3Length(vector));\n    return [\n      vector[0] * im,\n      vector[1] * im,\n      vector[2] * im\n    ];\n  },\n\n  /**\n   * The dot product of a and b, two 3-element vectors.\n   * From: https://code.google.com/p/webgl-mjs/source/browse/mjs.js\n   */\n  v3Dot(a, b) {\n    return a[0] * b[0] +\n           a[1] * b[1] +\n           a[2] * b[2];\n  },\n\n  /**\n   * From:\n   * http://www.opensource.apple.com/source/WebCore/WebCore-514/platform/graphics/transforms/TransformationMatrix.cpp\n   */\n  v3Combine(\n    a: Array<number>,\n    b: Array<number>,\n    aScale: number,\n    bScale: number\n  ): Array<number> {\n    return [\n      aScale * a[0] + bScale * b[0],\n      aScale * a[1] + bScale * b[1],\n      aScale * a[2] + bScale * b[2]\n    ];\n  },\n\n  /**\n   * From:\n   * http://www.opensource.apple.com/source/WebCore/WebCore-514/platform/graphics/transforms/TransformationMatrix.cpp\n   */\n  v3Cross(a: Array<number>, b: Array<number>): Array<number> {\n    return [\n      a[1] * b[2] - a[2] * b[1],\n      a[2] * b[0] - a[0] * b[2],\n      a[0] * b[1] - a[1] * b[0]\n    ];\n  },\n\n  /**\n   * Based on:\n   * http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToEuler/\n   * and:\n   * http://quat.zachbennett.com/\n   *\n   * Note that this rounds degrees to the thousandth of a degree, due to\n   * floating point errors in the creation of the quaternion.\n   *\n   * Also note that this expects the qw value to be last, not first.\n   *\n   * Also, when researching this, remember that:\n   * yaw   === heading            === z-axis\n   * pitch === elevation/attitude === y-axis\n   * roll  === bank               === x-axis\n   */\n  quaternionToDegreesXYZ(q: Array<number>, matrix, row): Array<number> {\n    var [qx, qy, qz, qw] = q;\n    var qw2 = qw * qw;\n    var qx2 = qx * qx;\n    var qy2 = qy * qy;\n    var qz2 = qz * qz;\n    var test = qx * qy + qz * qw;\n    var unit = qw2 + qx2 + qy2 + qz2;\n    var conv = 180 / Math.PI;\n\n    if (test > 0.49999 * unit) {\n      return [0, 2 * Math.atan2(qx, qw) * conv, 90];\n    }\n    if (test < -0.49999 * unit) {\n      return [0, -2 * Math.atan2(qx, qw) * conv, -90];\n    }\n\n    return [\n      MatrixMath.roundTo3Places(\n        Math.atan2(2*qx*qw-2*qy*qz,1-2*qx2-2*qz2) * conv\n      ),\n      MatrixMath.roundTo3Places(\n        Math.atan2(2*qy*qw-2*qx*qz,1-2*qy2-2*qz2) * conv\n      ),\n      MatrixMath.roundTo3Places(\n        Math.asin(2*qx*qy+2*qz*qw) * conv\n      )\n    ];\n  },\n\n  /**\n   * Based on:\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/round\n   */\n  roundTo3Places(n: number): number {\n    var arr = n.toString().split('e');\n    return Math.round(arr[0] + 'e' + (arr[1] ? (+arr[1] - 3) : 3)) * 0.001;\n  },\n\n  /**\n   * Decompose a matrix into separate transform values, for use on platforms\n   * where applying a precomposed matrix is not possible, and transforms are\n   * applied in an inflexible ordering (e.g. Android).\n   *\n   * Implementation based on\n   * http://www.w3.org/TR/css3-transforms/#decomposing-a-2d-matrix\n   * http://www.w3.org/TR/css3-transforms/#decomposing-a-3d-matrix\n   * which was based on\n   * http://tog.acm.org/resources/GraphicsGems/gemsii/unmatrix.c\n   */\n  decomposeMatrix(transformMatrix: Array<number>): ?Object {\n\n    invariant(\n      transformMatrix.length === 16,\n      'Matrix decomposition needs a list of 3d matrix values, received %s',\n      transformMatrix\n    );\n\n    // output values\n    var perspective = [];\n    var quaternion = [];\n    var scale = [];\n    var skew = [];\n    var translation = [];\n\n    // create normalized, 2d array matrix\n    // and normalized 1d array perspectiveMatrix with redefined 4th column\n    if (!transformMatrix[15]) {\n      return;\n    }\n    var matrix = [];\n    var perspectiveMatrix = [];\n    for (var i = 0; i < 4; i++) {\n      matrix.push([]);\n      for (var j = 0; j < 4; j++) {\n        var value = transformMatrix[(i * 4) + j] / transformMatrix[15];\n        matrix[i].push(value);\n        perspectiveMatrix.push(j === 3 ? 0 : value);\n      }\n    }\n    perspectiveMatrix[15] = 1;\n\n    // test for singularity of upper 3x3 part of the perspective matrix\n    if (!MatrixMath.determinant(perspectiveMatrix)) {\n      return;\n    }\n\n    // isolate perspective\n    if (matrix[0][3] !== 0 || matrix[1][3] !== 0 || matrix[2][3] !== 0) {\n      // rightHandSide is the right hand side of the equation.\n      // rightHandSide is a vector, or point in 3d space relative to the origin.\n      var rightHandSide = [\n        matrix[0][3],\n        matrix[1][3],\n        matrix[2][3],\n        matrix[3][3]\n      ];\n\n      // Solve the equation by inverting perspectiveMatrix and multiplying\n      // rightHandSide by the inverse.\n      var inversePerspectiveMatrix = MatrixMath.inverse(\n        perspectiveMatrix\n      );\n      var transposedInversePerspectiveMatrix = MatrixMath.transpose(\n        inversePerspectiveMatrix\n      );\n      var perspective = MatrixMath.multiplyVectorByMatrix(\n        rightHandSide,\n        transposedInversePerspectiveMatrix\n      );\n    } else {\n      // no perspective\n      perspective[0] = perspective[1] = perspective[2] = 0;\n      perspective[3] = 1;\n    }\n\n    // translation is simple\n    for (var i = 0; i < 3; i++) {\n      translation[i] = matrix[3][i];\n    }\n\n    // Now get scale and shear.\n    // 'row' is a 3 element array of 3 component vectors\n    var row = [];\n    for (i = 0; i < 3; i++) {\n      row[i] = [\n        matrix[i][0],\n        matrix[i][1],\n        matrix[i][2]\n      ];\n    }\n\n    // Compute X scale factor and normalize first row.\n    scale[0] = MatrixMath.v3Length(row[0]);\n    row[0] = MatrixMath.v3Normalize(row[0], scale[0]);\n\n    // Compute XY shear factor and make 2nd row orthogonal to 1st.\n    skew[0] = MatrixMath.v3Dot(row[0], row[1]);\n    row[1] = MatrixMath.v3Combine(row[1], row[0], 1.0, -skew[0]);\n\n    // Compute XY shear factor and make 2nd row orthogonal to 1st.\n    skew[0] = MatrixMath.v3Dot(row[0], row[1]);\n    row[1] = MatrixMath.v3Combine(row[1], row[0], 1.0, -skew[0]);\n\n    // Now, compute Y scale and normalize 2nd row.\n    scale[1] = MatrixMath.v3Length(row[1]);\n    row[1] = MatrixMath.v3Normalize(row[1], scale[1]);\n    skew[0] /= scale[1];\n\n    // Compute XZ and YZ shears, orthogonalize 3rd row\n    skew[1] = MatrixMath.v3Dot(row[0], row[2]);\n    row[2] = MatrixMath.v3Combine(row[2], row[0], 1.0, -skew[1]);\n    skew[2] = MatrixMath.v3Dot(row[1], row[2]);\n    row[2] = MatrixMath.v3Combine(row[2], row[1], 1.0, -skew[2]);\n\n    // Next, get Z scale and normalize 3rd row.\n    scale[2] = MatrixMath.v3Length(row[2]);\n    row[2] = MatrixMath.v3Normalize(row[2], scale[2]);\n    skew[1] /= scale[2];\n    skew[2] /= scale[2];\n\n    // At this point, the matrix (in rows) is orthonormal.\n    // Check for a coordinate system flip.  If the determinant\n    // is -1, then negate the matrix and the scaling factors.\n    var pdum3 = MatrixMath.v3Cross(row[1], row[2]);\n    if (MatrixMath.v3Dot(row[0], pdum3) < 0) {\n      for (i = 0; i < 3; i++) {\n        scale[i] *= -1;\n        row[i][0] *= -1;\n        row[i][1] *= -1;\n        row[i][2] *= -1;\n      }\n    }\n\n    // Now, get the rotations out\n    quaternion[0] =\n      0.5 * Math.sqrt(Math.max(1 + row[0][0] - row[1][1] - row[2][2], 0));\n    quaternion[1] =\n      0.5 * Math.sqrt(Math.max(1 - row[0][0] + row[1][1] - row[2][2], 0));\n    quaternion[2] =\n      0.5 * Math.sqrt(Math.max(1 - row[0][0] - row[1][1] + row[2][2], 0));\n    quaternion[3] =\n      0.5 * Math.sqrt(Math.max(1 + row[0][0] + row[1][1] + row[2][2], 0));\n\n    if (row[2][1] > row[1][2]) {\n      quaternion[0] = -quaternion[0];\n    }\n    if (row[0][2] > row[2][0]) {\n      quaternion[1] = -quaternion[1];\n    }\n    if (row[1][0] > row[0][1]) {\n      quaternion[2] = -quaternion[2];\n    }\n\n    // correct for occasional, weird Euler synonyms for 2d rotation\n    var rotationDegrees;\n    if (\n      quaternion[0] < 0.001 && quaternion[0] >= 0 &&\n      quaternion[1] < 0.001 && quaternion[1] >= 0\n    ) {\n      // this is a 2d rotation on the z-axis\n      rotationDegrees = [0, 0, MatrixMath.roundTo3Places(\n        Math.atan2(row[0][1], row[0][0]) * 180 / Math.PI\n      )];\n    } else {\n      rotationDegrees = MatrixMath.quaternionToDegreesXYZ(quaternion, matrix, row);\n    }\n\n    // expose both base data and convenience names\n    return {\n      rotationDegrees,\n      perspective,\n      quaternion,\n      scale,\n      skew,\n      translation,\n\n      rotate: rotationDegrees[2],\n      rotateX: rotationDegrees[0],\n      rotateY: rotationDegrees[1],\n      scaleX: scale[0],\n      scaleY: scale[1],\n      translateX: translation[0],\n      translateY: translation[1],\n    };\n  },\n\n};\n\nmodule.exports = MatrixMath;\n"]}